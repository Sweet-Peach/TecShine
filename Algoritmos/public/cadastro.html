<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="./js/funcoes.js"></script>
    <link rel="stylesheet" href="./css/main-style.css">
    <link rel="stylesheet" href="./css/cadastro.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-container">
                <a href="./index.html" class="header-acesso-index" id="header_logo_div">
                    <div id="div-header-container-logo">
                        <img src="./img/Component 3.png" alt="" class="img" id="header_img">
                        <h1 class="logo-text" id="header_titulo">TECSHINE</h1>
                    </div>
                </a>
                <ul class="header-nav-bar">
                    <li id="li-left"><a href="./index.html" class="nav-bar-li">Home</a></li>
                    <li id="li-center"><a href="./about-us.html" class="nav-bar-li">Sobre</a></li>
                    <li id="li-right"><a href="./contato.html" class="nav-bar-li">Contato</a></li>
                </ul>
                <div class="div-header-container-login-cadastro">
                    <a href="./login.html" id="btn-login">Login</a>
                </div>
            </div>
        </div>
    </header>

    <section class="cadastro">
        <div class="container">
            <div class="cadastro-container">
                <div class="cadastro-form">
                    <div class="textos">
                        <h1 class="titulo">CADASTRO</h1>
                        <p>Não é  cliente? Faça seu cadastro!</p>
                    </div>
                    <div class="form">
                        <div class="row-1 row">
                            <label for="inp_razaosocial" >*Razão Social:</label><input type="text" name="inpt_razaosocial" id="inp_razaosocial" >
                            <label for="inp_cnpj" id="label-inp_cnpj">*CNPJ:</label><input type="text" name="inpt_cnpj" id="inp_cnpj" oninput="maskCNPJ(this.value,document.getElementById('inp_cnpj'))">
                        </div>
                        <div class="row-2 row">
                            <label for="inp_resp">Nome do Responsável: </label><input type="text" name="inpt_resp" id="inp_resp" >
                            <label for="inp_tel" id="label-inp_tel">*Telefone</label><input type="text" name="inpt_tel" id="inp_tel" >
                        </div>
                        <div class="row-3 row">
                            <label for="inp_cep">*CEP:</label><input type="text" name="inpt_cep" id="inp_cep">
                            <label for="inp_end">*Endereço:</label><input type="text" name="inpt_end" id="inp_end" >
                            <label for="inp_n">*Número:</label><input type="text" name="inpt_n" id="inp_n" >
                        </div>
                        <div class="row-4 row"><label for="inp_email">Email:</label><input type="text" name="inpt_email" id="inp_email" ></div>
                        <div class="row-5 row">
                            <label for="inp_senha">*Senha:</label><input type="text" name="inp_senha" id="inp_senha" >
                            <label for="inp_senhaconfirm">Confirmar Senha:</label><input type="text" name="inp_tsenhaconfirm" id="inp_senhaconfirm" >
                        </div>
                        
                    </div>
                    <button onclick="cadastrar()">Vamos lá!</button>
                </div>
                <div class="img">
                    <img src="./img/Group 10.png" alt="">
                </div>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <div class="div-footer1">
                <p class="footer-direitos">Todos os direitos reservados para o site TecShine         ©2021 </p>
            </div>
            <div class="div-footer2">
                <img src="./img/instagram 1.png" alt="" class="redes-sociais">
                <img src="./img/facebook 1.png" alt="" class="redes-sociais">
                <img src="./img/twitter 1.png" alt="" class="redes-sociais">
            </div>
        </div>
    </footer>
</body>
</html>
<!-- <script>

    function maskCNPJ(value , id){
        var x = value.replace(/\D/g, '').match(/(\d{0,2})(\d{0,3})(\d{0,3})(\d{0,4})(\d{0,2})/);

        id.value = !x[2] ? x[1] : x[1] + '.' + x[2] + '.' + x[3] + '/' + x  [4] + (x[5] ? '-' + x[5] : '');
    }

    function cadastrar() {
        aguardar();
        /* 
        a primeira parte do processo é recolher o valor das coisas inseridas nos inputs
        essas variáveis são as informações obrigatórias, marcadas com * no site
        */
        var razao_socialVar = inp_razaosocial.value
        var cnpjVar = (inp_cnpj.value).replace(/\D/g,'');
        var respVar = inp_resp;
        var telefoneVar = inp_tel.value;
        var cepVar = inp_cep.value;
        var enderecoVar = inp_end.value;
        var numeroVar = inp_n.value;
        var emailVar = inp_email.value;
        var senhaVar = inp_senha.value;
        var confirmVar = inp_senhaconfirm.value

        // Agora tem de verificar se esses campos não estão vazios
        // if (razao_social && cnpj && cep && endereco && senha && telefone)  {
        //         if(cnpj.length == 18){
        //             if (telefone.length == 11 || telefone.length == 10){
        //                 if (cep.length == 8){
        //                     if (senha.length>= 8){
        //                         if (senha == confirm){
        //                             window.location.replace("login.html");
        //                         } else {
        //                             alert("As senhas não batem")
        //                         }
        //                     } else {
        //                         alert("A senha tem de ter pelo menos 8 caracteres")
        //                     }
        //                 } else{
        //                     alert("O CEP têm de ter 8 números!")
        //                 }
        //             } else{
        //                 alert("Digite o telefone corretamente, somente o DDD e o número")
        //             }
        //         } else {
        //             alert("cnpj inválido")
        //         }
        // } else {
        //     alert("preencha todos os campos obrigatórios")
        // }


    if (razao_socialVar == "" || cnpjVar == "" || telefoneVar == "" || cepVar == "" || enderecoVar == "" || senhaVar == "" || confirmVar == "") {

                window.alert("Preencha todos os campos para prosseguir!");
                if (razao_socialVar == "") {
                    console.log('razão social está em branco')
                }
                if (cnpjVar == "") {
                    console.log('cnpj está em branco')
                }
                if (telefoneVar == "") {
                    console.log('telefone está em branco')
                }
                if (cepVar == "") {
                    console.log('CEP está em branco')
                }
                if (enderecoVar == "") {
                    console.log('endereço está em branco')
                }
                if (senhaVar == "") {
                    console.log('senha está em branco')
                }
                if (confirmVar == "") {
                    console.log('confirmação da senha está em branco')
                }
                finalizarAguardar();
                return false;
                }

                // if (emailVar.indexOf("@") == -1 || emailVar.indexOf(".com") == -1) {
                // window.alert("Ops, e-mail inválido! Verifique e tente novamente.");
                // finalizarAguardar();
                // return false;
                // }

                if (senhaVar != confirmVar) {
                window.alert("As senhas inseridas devem ser iguais para prosseguir!");
                finalizarAguardar();
                return false;
                }

                fetch("/usuarios/cadastrar", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    razao_socialServer: razao_socialVar,
                    cnpjServer: cnpjVar,
                    respServer: respVar,
                    telefoneServer: telefoneVar,
                    cepServer: cepVar,
                    enderecoServer: enderecoVar,
                    numeroServer: numeroVar,
                    emailServer : emailVar,   
                    senhaServer: senhaVar

                })
                }).then(function (resposta) {

                console.log("resposta: ", resposta);

                if (resposta.ok) {
                    window.alert("Cadastro realizado com sucesso!");
                    window.location = "login.html";
                    limparFormulario();
                    finalizarAguardar();
                } else {
                    throw ("Houve um erro ao tentar realizar o cadastro!");
                }
                }).catch(function (resposta) {
                console.log(`#ERRO: ${resposta}`);
                finalizarAguardar();
                });

                    return false;

    }

    
    
</script> -->


<script>

function maskCNPJ(value , id){
        var x = value.replace(/\D/g, '').match(/(\d{0,2})(\d{0,3})(\d{0,3})(\d{0,4})(\d{0,2})/);

        id.value = !x[2] ? x[1] : x[1] + '.' + x[2] + '.' + x[3] + '/' + x  [4] + (x[5] ? '-' + x[5] : '');
    }

    function cadastrar() {
        // aguardar();

        var razao_socialVar = inp_razaosocial.value
        var cnpjVar = (inp_cnpj.value).replace(/\D/g,'');
        var respVar = inp_resp;
        var telefoneVar = inp_tel.value;
        var cepVar = inp_cep.value;
        var enderecoVar = inp_end.value;
        var numeroVar = inp_n.value;
        var emailVar = inp_email.value;
        var senhaVar = inp_senha.value;
        var confirmVar = inp_senhaconfirm.value;

        if (razao_socialVar == "" || cnpjVar == "" || telefoneVar == "" || cepVar == "" || enderecoVar == "" || senhaVar == "" || confirmVar == "") {
        window.alert("Preencha todos os campos para prosseguir!");
        if (razao_socialVar == "") {
            console.log('razão social está em branco')
        }
        if (cnpjVar == "") {
            console.log('cnpj está em branco')
        }
        if (telefoneVar == "") {
            console.log('telefone está em branco')
        }
        if (cepVar == "") {
            console.log('CEP está em branco')
        }
        if (enderecoVar == "") {
            console.log('endereço está em branco')
        }
        if (senhaVar == "") {
            console.log('senha está em branco')
        }
        if (confirmVar == "") {
            console.log('confirmação da senha está em branco')
        }
        // finalizarAguardar();
        return false;
        }

        if (emailVar.indexOf("@") == -1 || emailVar.indexOf(".com") == -1) {
            window.alert("Ops, e-mail inválido! Verifique e tente novamente.");
            // finalizarAguardar();
            return false;
        }

        if (senhaVar != confirmVar) {
            window.alert("As senhas inseridas devem ser iguais para prosseguir!");
            // finalizarAguardar();
            return false;
        }

        fetch("/usuarios/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                    razao_socialServer: razao_socialVar,
                    cnpjServer: cnpjVar,
                    respServer: respVar,
                    telefoneServer: telefoneVar,
                    cepServer: cepVar,
                    enderecoServer: enderecoVar,
                    numeroServer: numeroVar,
                    emailServer : emailVar,   
                    senhaServer: senhaVar
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                window.alert("Cadastro realizado com sucesso!");
                window.location = "login.html";
                limparFormulario();
                // finalizarAguardar();
            } else {
                throw ("Houve um erro ao tentar realizar o cadastro!");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
            // finalizarAguardar();
        });

        return false;
    }

</script>